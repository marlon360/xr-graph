<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>XR Graph - Augmented Reality</title>
    <style>
        .buttons {
            position: fixed;
            left: 0;
            right: 0;
            bottom: 10px;
            padding: 10px;
        }
        .buttons#tracking {
            display: none;
        }
        .buttons#no-tracking {
            display: block;
        }
        .tracked .buttons#tracking {
            display: block;
        }
        .tracked .buttons#no-tracking {
            display: none;
        }

        .buttons button, .buttons a {
            border: 0;
            background: rgba(19, 19, 19, 0.7);
            padding: 0.6em 1em;
            font-size: 1em;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            margin: 4px;
        }
    </style>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-41295198-4"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-41295198-4');
    </script>
</head>

<!-- start the body of your page -->
<body style='margin : 0px; overflow: hidden;'>
    <div class="menu-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48px" height="48px"><linearGradient id="EIPc0qTNCX0EujYwtxKaXa" x1="12.066" x2="34.891" y1=".066" y2="22.891" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#63BFFF"/><stop offset="1" stop-color="#9446FF"/></linearGradient><path fill="url(#EIPc0qTNCX0EujYwtxKaXa)" d="M43,15H5c-1.1,0-2-0.9-2-2v-2c0-1.1,0.9-2,2-2h38c1.1,0,2,0.9,2,2v2C45,14.1,44.1,15,43,15z"/><linearGradient id="EIPc0qTNCX0EujYwtxKaXb" x1="12.066" x2="34.891" y1="12.066" y2="34.891" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#63BFFF"/><stop offset="1" stop-color="#9446FF"/></linearGradient><path fill="url(#EIPc0qTNCX0EujYwtxKaXb)" d="M43,27H5c-1.1,0-2-0.9-2-2v-2c0-1.1,0.9-2,2-2h38c1.1,0,2,0.9,2,2v2C45,26.1,44.1,27,43,27z"/><linearGradient id="EIPc0qTNCX0EujYwtxKaXc" x1="12.066" x2="34.891" y1="24.066" y2="46.891" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#63BFFF"/><stop offset="1" stop-color="#9446FF"/></linearGradient><path fill="url(#EIPc0qTNCX0EujYwtxKaXc)" d="M43,39H5c-1.1,0-2-0.9-2-2v-2c0-1.1,0.9-2,2-2h38c1.1,0,2,0.9,2,2v2C45,38.1,44.1,39,43,39z"/></svg>
      </div>
      <div class="menu closed">
        <div class="menu-inner">
          <h1>XR Graph</h1>
          <a target="_blank" id="marker-link" class="button">Download Marker</a>
          <h2>Function:</h2>
          <input class="function-input" type="text">
          <div style="display: flex; justify-content: flex-end;">
            <button class="update-button">Update</button>
          </div>
          <p>
            How to write a function:<br>
            Declare parameters with <em>f(u,v)</em><br>
            Declare a vector with square brackets <em>[x,y,z]</em>
          </p>
          <h2>Examples:</h2>
          <div class="examples">
            <a href="?function=f(t)%3D[cos(t),sin(t),t]">f(t)=[cos(t), sin(t), t]</a>
            <a href="?function=f(u,v)%3D[u,v,u*v*0.1]">f(u,v)=[u, v, u*v*0.1]</a>
            <a href="?function=f(u,v)%3D[cos(u),sin(v),2 * cos(v)]">f(u,v)=[cos(u),sin(v),2 * cos(v)]</a>
            <a href="?function=[sin(t)%20+%202%20*%20sin(2*t),%20cos(t)%20-%202%20*%20cos(2*t),%20-sin(3*t)]&tMin=0&tMax=6.3&aMin=0&aMax=3&a=1.5&bMin=0&bMax=3&b=1.5">Trefoil Knot</a>
            <a href="?function=[(a+b*u*cos(0.5*v))*cos(v),%20(a+b*u*cos(0.5*v))*sin(v),%20b*u*sin(0.5*v)]&uMin=-0.5&uMax=0.5&vMin=0&vMax=6.283185307179586&xMin=-1.3231280219206423&xMax=1.8&yMin=-1.6624317662557717&yMax=1.6624317662557717&aMin=1&aMax=2&a=1.5384151615841295&bMin=0.2&bMax=1.5&b=0.9618813442348404">MÃ¶bius strip</a>
            <a href="?function=[b%20*%20u%20*%20cos(a%20*%20v),%20b%20*%20u%20*%20sin(a%20*%20v),%200.2%20*%20v]&uMin=-2&uMax=2&vMin=-10&vMax=10&xMin=-2&xMax=2&yMin=-1.9999311713564978&yMax=1.9999311713564978&aMin=0&aMax=1.1&a=0.8800000000000001&bMin=0&bMax=1&b=0.8">Helicoid</a>
            <a href="?function=[cos(u)%20*%20(a%20+%20b%20*%20cos(v)),%20sin(u)%20*%20(a%20+%20b%20*%20cos(v)),%20b%20*%20sin(v)]&uMin=0&uMax=6.283185307179586&vMin=0&vMax=6.283185307179586&xMin=-2&xMax=2&yMin=-2&yMax=2&aMin=0&aMax=2&a=1.3&bMin=0&bMax=1&b=0.3">Torus</a>
          </div>
    
          <h2>Browser Addons:</h2>
          <a target="_blank" href="https://addons.mozilla.org/en-US/firefox/addon/xr-graph-browser-integration/" class="button">Get Firefox Addon</a>
          <a target="_blank" href="https://chrome.google.com/webstore/detail/xr-graph-browser-integrat/mkapnmjibodohclhpalpcohdibinijfi?hl=en" class="button">Get Chrome Addon</a>
    
          <h2>Support</h2>
          <script type='text/javascript' src='https://ko-fi.com/widgets/widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Support Me on Ko-fi', '#29abe0', 'Q5Q71M4SL');kofiwidget2.draw();</script> 
        </div>
      </div>
	<!-- Define your 3d scene and enabled ar.js -->
	<a-scene embedded vr-mode-ui="enabled: false" arjs='trackingMethod: best;debugUIEnabled: false;' gesture-detector>
		
		<a-marker markerhandler id="marker" type="pattern">
            <a-entity gesture-handler="minScale: 0.25; maxScale: 5; rotationXEnabled: false" id="plot" scale="1 1 1" position="0 0.5 0" graph="xMin: -7; xMax: 7; zMin: 0; zMax: 6.3; segmentsMultiplier: 2; showGrid: false; showGridLabels: false; function: f(u,v) = [v * cos(u), v * sin(u), u]"></a-entity >
        </a-marker>

		<a-entity camera></a-entity>
    </a-scene>
    <div class="buttons" id="tracking">
        <button id="wireframe-button">Toggle Wireframe</button>
        <button id="grid-button">Toggle Grid</button>
        
    </div>
    <div class="buttons" id="no-tracking">
        <a target="_blank" id="marker-link-inapp" class="button">Download Marker</a>
    </div>
</body>
<script>

    const plot = document.querySelector("#plot");
  
  const getAllGetParameters = () => {
    parameters = {};
    location.search
        .substr(1)
        .split("&")
        .forEach(function (item) {
          tmp = item.split("=");
          parameters[tmp[0]] = decodeURIComponent(tmp[1]);
        });
    return parameters
  }

  plot.setAttribute('graph', getAllGetParameters());

    let showWireframe = false;
    let showGrid = false;

    wireframeButton = document.querySelector("#wireframe-button");
    wireframeButton.addEventListener('click', (evt) => {
        showWireframe = !showWireframe
        plot.setAttribute("graph", {
            showWireframe: showWireframe
        })
    })
    wireframeButton = document.querySelector("#grid-button");
    wireframeButton.addEventListener('click', (evt) => {
        showGrid = !showGrid;
        plot.setAttribute("graph", {
            showGrid: showGrid
        })
    })

    document.querySelector('.function-input').value = plot.components["graph"].data.function;
    document.querySelector('.update-button').addEventListener('click', () => {
        window.location.href = '?function=' + encodeURIComponent(document.querySelector('.function-input').value);
    })

    document.querySelector('.menu-icon').addEventListener('click', () => {
        document.querySelector('.menu').classList.toggle('closed');
    })

</script>
</html>